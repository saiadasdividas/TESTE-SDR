// Abrir m√≥dulo
function openModule(moduleNum) {
    if (!currentSDR) {
        alert('Fa√ßa login primeiro!');
        return;
    }
    
    currentModule = moduleNum;
    const module = moduleData[moduleNum];
    
    document.getElementById('modalTitle').textContent = module.title;
    
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = '';
    
    // Adicionar descri√ß√£o do m√≥dulo
    const descriptionDiv = document.createElement('div');
    descriptionDiv.innerHTML = `
        <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; margin-bottom: 25px; border-left: 4px solid #3b82f6;">
            <h4 style="color: #1e40af; margin-bottom: 10px; font-size: 1.1rem;">üìö Sobre este m√≥dulo:</h4>
            <p style="color: #1e3a8a; line-height: 1.6; margin: 0;">${module.description}</p>
        </div>
    `;
    modalBody.appendChild(descriptionDiv);
    
    module.questions.forEach((question, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'practice-area';
        questionDiv.innerHTML = `
            <label style="font-size: 1.1rem; color: #1a365d; margin-bottom: 15px; display: block; font-weight: bold;">
                ${question.label}
            </label>
            
            <div style="background: #fef7e0; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #f59e0b;">
                <h5 style="color: #92400e; margin-bottom: 8px; font-size: 0.95rem;">üí° Como desenvolver uma boa resposta:</h5>
                <p style="color: #78350f; line-height: 1.5; margin: 0; font-size: 0.9rem;">${question.explanation}</p>
            </div>
            
            ${question.tips ? `
                <div style="background: #ecfdf5; padding: 12px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #10b981;">
                    <p style="color: #047857; line-height: 1.4; margin: 0; font-size: 0.85rem; font-weight: 500;">${question.tips}</p>
                </div>
            ` : ''}
            
            <textarea 
                id="question_${moduleNum}_${index}" 
                placeholder="${question.placeholder}"
                data-module="${moduleNum}"
                data-question="${index}"
                style="min-height: 180px; font-size: 14px; line-height: 1.5;">
            </textarea>
            
            <div style="margin-top: 8px; font-size: 0.8rem; color: #718096;">
                <span id="charCount_${moduleNum}_${index}">0</span> caracteres ‚Ä¢ M√≠nimo recomendado: 200 caracteres
            </div>
        `;
        modalBody.appendChild(questionDiv);
    });
    
    // Atualizar status de completude
    updateCompletionStatus(moduleNum);
    
    // Adicionar listeners
    addTextareaListeners(moduleNum<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Treinamento SDR - Embalagens Conceito</title>
<!-- Firebase SDK -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.min.js"></script>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Arial', sans-serif;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
min-height: 100vh;
color: #333;
}

.container {
max-width: 1200px;
margin: 0 auto;
padding: 20px;
}

.header {
text-align: center;
margin-bottom: 40px;
background: white;
padding: 30px;
border-radius: 20px;
box-shadow: 0 15px 35px rgba(0,0,0,0.1);
}

.header h1 {
color: #4a5568;
font-size: 2.5rem;
margin-bottom: 10px;
font-weight: bold;
}

.header p {
color: #718096;
font-size: 1.2rem;
}

/* Login Section */
.login-section {
margin-top: 20px;
padding: 20px;
background: #f8fafc;
border-radius: 15px;
border: 2px solid #e2e8f0;
}

.login-form {
display: flex;
gap: 15px;
justify-content: center;
align-items: center;
flex-wrap: wrap;
margin-bottom: 15px;
}

.login-form input {
padding: 12px 15px;
border-radius: 10px;
border: 2px solid #e2e8f0;
font-size: 16px;
min-width: 200px;
}

.login-form input:focus {
outline: none;
border-color: #667eea;
}

.sdr-info {
display: none;
text-align: center;
padding: 15px;
background: #e6fffa;
border-radius: 10px;
border: 2px solid #38b2ac;
}

.cards-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
gap: 20px;
margin-bottom: 40px;
}

.card {
background: white;
border-radius: 20px;
padding: 0;
box-shadow: 0 10px 25px rgba(0,0,0,0.1);
transition: all 0.3s ease;
overflow: hidden;
cursor: pointer;
min-height: 200px;
display: flex;
flex-direction: column;
}

.card:hover {
transform: translateY(-5px);
box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

.card.completed {
border: 3px solid #38a169;
}

.card.completed .card-header {
background: linear-gradient(135deg, #38a169 0%, #2f855a 100%);
}

.card-header {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: white;
padding: 25px;
text-align: center;
}

.card-header h3 {
font-size: 1.3rem;
font-weight: bold;
margin-bottom: 8px;
}

.card-description {
font-size: 0.9rem;
opacity: 0.95;
}

.card-content {
padding: 25px;
flex: 1;
display: flex;
flex-direction: column;
justify-content: center;
text-align: center;
}

.card-status {
font-size: 1.1rem;
color: #718096;
margin-bottom: 15px;
}

.card.completed .card-status {
color: #38a169;
font-weight: bold;
}

.card-disabled {
opacity: 0.6;
cursor: not-allowed;
}

.card-disabled:hover {
transform: none;
box-shadow: 0 10px 25px rgba(0,0,0,0.1);
}

.progress-section {
background: white;
border-radius: 20px;
padding: 30px;
box-shadow: 0 15px 35px rgba(0,0,0,0.1);
margin-bottom: 30px;
}

.progress-section h2 {
color: #4a5568;
margin-bottom: 20px;
text-align: center;
}

.progress-bar {
width: 100%;
height: 20px;
background: #e2e8f0;
border-radius: 10px;
overflow: hidden;
margin-bottom: 15px;
}

.progress-fill {
height: 100%;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
width: 0%;
transition: width 0.5s ease;
border-radius: 10px;
}

.progress-text {
text-align: center;
color: #718096;
font-weight: bold;
font-size: 1.1rem;
}

/* Modal Styles */
.modal {
display: none;
position: fixed;
z-index: 1000;
left: 0;
top: 0;
width: 100%;
height: 100%;
background-color: rgba(0,0,0,0.8);
animation: fadeIn 0.3s ease;
}

.modal-content {
background-color: white;
margin: 5% auto;
padding: 0;
border-radius: 20px;
width: 90%;
max-width: 800px;
max-height: 85vh;
overflow-y: auto;
animation: slideIn 0.3s ease;
}

.modal-header {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: white;
padding: 25px;
border-radius: 20px 20px 0 0;
display: flex;
justify-content: space-between;
align-items: center;
}

.modal-header h2 {
margin: 0;
font-size: 1.5rem;
}

.close {
color: white;
font-size: 28px;
font-weight: bold;
cursor: pointer;
}

.close:hover {
opacity: 0.8;
}

.modal-body {
padding: 30px;
}

.practice-area {
margin-bottom: 25px;
}

.practice-area label {
display: block;
margin-bottom: 10px;
font-weight: bold;
color: #2d3748;
font-size: 1.1rem;
}

.practice-area textarea {
width: 100%;
min-height: 120px;
padding: 15px;
border: 2px solid #e2e8f0;
border-radius: 10px;
font-family: inherit;
font-size: 14px;
transition: border-color 0.3s ease;
resize: vertical;
}

.practice-area textarea:focus {
outline: none;
border-color: #667eea;
box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.modal-footer {
padding: 20px 30px;
border-top: 1px solid #e2e8f0;
display: flex;
justify-content: space-between;
align-items: center;
}

.btn {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
color: white;
border: none;
padding: 12px 25px;
border-radius: 10px;
font-size: 16px;
font-weight: bold;
cursor: pointer;
transition: transform 0.2s ease;
}

.btn:hover {
transform: translateY(-2px);
}

.btn-secondary {
background: #718096;
}

.btn:disabled {
background: #a0aec0;
cursor: not-allowed;
transform: none;
}

.completion-status {
font-size: 0.9rem;
color: #718096;
}

@keyframes fadeIn {
from { opacity: 0; }
to { opacity: 1; }
}

@keyframes slideIn {
from { transform: translateY(-50px); opacity: 0; }
to { transform: translateY(0); opacity: 1; }
}

@media (max-width: 768px) {
.container {
padding: 15px;
}

.header h1 {
font-size: 2rem;
}

.cards-grid {
grid-template-columns: 1fr;
gap: 15px;
}

.login-form {
flex-direction: column;
align-items: stretch;
}

.login-form input {
min-width: auto;
}

.modal-content {
width: 95%;
margin: 10% auto;
}
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>üéØ Treinamento SDR</h1>
<p>Embalagens Conceito - Dominando a Arte da Prospec√ß√£o B2B</p>

<div class="login-section">
<div id="loginForm" class="login-form">
<input type="text" id="sdrName" placeholder="Seu nome completo">
<input type="email" id="sdrEmail" placeholder="Seu e-mail">
<button class="btn" onclick="initializeSDR()">Iniciar Treinamento</button>
</div>
<div id="sdrInfo" class="sdr-info">
<p><strong>SDR:</strong> <span id="currentSDRName"></span> | <strong>Iniciado em:</strong> <span id="startTime"></span></p>
<button class="btn btn-secondary" onclick="logoutSDR()">Finalizar Sess√£o</button>
</div>
</div>
</div>

<div class="progress-section">
<h2>üìà Seu Progresso no Treinamento</h2>
<div class="progress-bar">
<div class="progress-fill" id="progressFill"></div>
</div>
<div class="progress-text" id="progressText">Fa√ßa login para come√ßar</div>
</div>

<div class="cards-grid" id="cardsGrid">
<div class="card card-disabled" data-module="1">
<div class="card-header">
<h3>üè™ Identifica√ß√£o de Oportunidades</h3>
<div class="card-description">Reconhe√ßa sinais de que lojistas precisam de fornecedores</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Aprenda a identificar oportunidades de neg√≥cio com lojistas e distribuidores.</p>
</div>
</div>

<div class="card card-disabled" data-module="2">
<div class="card-header">
<h3>üéØ Perfil do Cliente Ideal</h3>
<div class="card-description">Defina seu p√∫blico-alvo perfeito</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Construa o perfil detalhado dos lojistas ideais para seu produto.</p>
</div>
</div>

<div class="card card-disabled" data-module="3">
<div class="card-header">
<h3>üìû T√©cnicas de Qualifica√ß√£o</h3>
<div class="card-description">Domine a metodologia BANT</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Aprenda a qualificar prospects usando Budget, Authority, Need e Timeline.</p>
</div>
</div>

<div class="card card-disabled" data-module="4">
<div class="card-header">
<h3>üìß Scripts de E-mail</h3>
<div class="card-description">Crie e-mails que convertem</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Desenvolva templates eficazes para diferentes momentos da prospec√ß√£o.</p>
</div>
</div>

<div class="card card-disabled" data-module="5">
<div class="card-header">
<h3>‚òéÔ∏è Scripts de Cold Call</h3>
<div class="card-description">Domine as liga√ß√µes de prospec√ß√£o</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Crie abordagens eficazes e trate obje√ß√µes com confian√ßa.</p>
</div>
</div>

<div class="card card-disabled" data-module="6">
<div class="card-header">
<h3>üîç Pesquisa e Prospecting</h3>
<div class="card-description">Encontre prospects qualificados</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Domine t√©cnicas de pesquisa para encontrar lojistas ideais.</p>
</div>
</div>

<div class="card card-disabled" data-module="7">
<div class="card-header">
<h3>üõ°Ô∏è Tratamento de Obje√ß√µes</h3>
<div class="card-description">Transforme "n√£o" em oportunidade</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Aprenda a lidar com as obje√ß√µes mais comuns dos lojistas.</p>
</div>
</div>

<div class="card card-disabled" data-module="8">
<div class="card-header">
<h3>üîÑ Follow-up Estrat√©gico</h3>
<div class="card-description">Converta prospects ao longo do tempo</div>
</div>
<div class="card-content">
<div class="card-status">Clique para iniciar</div>
<p>Desenvolva uma estrat√©gia sistem√°tica de acompanhamento.</p>
</div>
</div>
</div>
</div>

<!-- Modal -->
<div id="trainingModal" class="modal">
<div class="modal-content">
<div class="modal-header">
<h2 id="modalTitle">M√≥dulo de Treinamento</h2>
<span class="close" onclick="closeModal()">&times;</span>
</div>
<div class="modal-body" id="modalBody">
<!-- Conte√∫do ser√° inserido dinamicamente -->
</div>
<div class="modal-footer">
<div class="completion-status" id="completionStatus">
<span id="answeredCount">0</span> de <span id="totalQuestions">0</span> perguntas respondidas
</div>
<button class="btn" id="completeBtn" onclick="completeModule()" disabled>Concluir M√≥dulo</button>
</div>
</div>
</div>

<script>
// Configura√ß√£o do Firebase
const firebaseConfig = {
    apiKey: "AIzaSyAxkOOHB1m2vhleekARWnXyhnTjCt251LQ",
    authDomain: "plataforma-de-treinament-9a00b.firebaseapp.com",
    projectId: "plataforma-de-treinament-9a00b",
    storageBucket: "plataforma-de-treinament-9a00b.firebasestorage.app",
    messagingSenderId: "192125351398",
    appId: "1:192125351398:web:c16cc461c4c853132a1227"
};

// Inicializar Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Vari√°veis globais
let currentSDR = null;
let sessionId = null;
let trainingStartTime = null;
let currentModule = null;
let completedModules = [];

// Dados dos m√≥dulos
const moduleData = {
    1: {
        title: "üè™ Identifica√ß√£o de Oportunidades",
        description: "Aprenda a reconhecer sinais claros de que uma loja ou distribuidor est√° precisando de novos fornecedores de embalagens. Esta habilidade √© fundamental para um SDR eficaz.",
        questions: [
            {
                label: "Liste 3 indicadores visuais ou comportamentais de que um lojista pode precisar de embalagens:",
                explanation: "Pense em sinais que voc√™ pode observar visitando a loja fisicamente ou atrav√©s das redes sociais. Considere aspectos como estoque, qualidade das embalagens atuais, expans√£o do neg√≥cio, reclama√ß√µes de clientes, etc.",
                placeholder: "Exemplo de resposta:\n\n1. ESTOQUE BAIXO VIS√çVEL: Prateleiras com poucas embalagens ou espa√ßos vazios onde normalmente ficam produtos de embalagem.\n\n2. EMBALAGENS ANTIGAS/DANIFICADAS: Produtos em embalagens amareladas, amassadas ou com design desatualizado em liquida√ß√£o.\n\n3. EXPANS√ÉO DO NEG√ìCIO: Loja em reforma, novos pontos de venda sendo abertos, ou posts nas redes sociais sobre crescimento.",
                tips: "üí° DICA: Visite lojas concorrentes, siga nas redes sociais, observe promo√ß√µes de liquida√ß√£o, converse com vendedores, monitore expans√µes e reformas na regi√£o."
            }
        ]
    },
    2: {
        title: "üéØ Perfil do Cliente Ideal",
        description: "Defina com precis√£o o perfil dos lojistas, distribuidores e lojas de doces que s√£o ideais para seu produto. Um ICP (Ideal Customer Profile) bem definido aumenta drasticamente sua taxa de convers√£o.",
        questions: [
            {
                label: "Descreva o perfil completo do lojista ideal para seu produto:",
                explanation: "Considere aspectos como: tempo de mercado, localiza√ß√£o, volume de vendas, se j√° revende embalagens, tamanho da equipe, tipo de clientela, faturamento estimado, etc. Seja espec√≠fico!",
                placeholder: "Exemplo de resposta:\n\n‚Ä¢ PERFIL: Loja de doces estabelecida h√° 2-5 anos\n‚Ä¢ LOCALIZA√á√ÉO: Shopping centers ou centros comerciais movimentados\n‚Ä¢ VOLUME: Vende 1000-3000 unidades de doces/m√™s\n‚Ä¢ FUNCION√ÅRIOS: 3-8 pessoas na equipe\n‚Ä¢ P√öBLICO: Classes B e C, foco em presentes e eventos\n‚Ä¢ CARACTER√çSTICA: J√° revende embalagens como produto complementar\n‚Ä¢ FATURAMENTO: Entre R$ 15.000 - R$ 50.000/m√™s",
                tips: "üí° DICA: Analise seus melhores clientes atuais. Que caracter√≠sticas eles t√™m em comum? Use essas informa√ß√µes para criar o perfil ideal."
            },
            {
                label: "Quais s√£o as 5 principais dores/problemas que esse lojista enfrenta?",
                explanation: "Pense nos desafios reais que impedem o crescimento do neg√≥cio. Dores relacionadas a fornecedores, custos, qualidade, prazos, variedade, atendimento, etc. Suas solu√ß√µes devem resolver essas dores.",
                placeholder: "Exemplo de resposta:\n\n1. FORNECEDORES INST√ÅVEIS: Dificuldade para encontrar fornecedores confi√°veis que entreguem no prazo\n\n2. PRE√áOS N√ÉO COMPETITIVOS: Margens baixas devido a pre√ßos altos dos fornecedores atuais\n\n3. VARIEDADE LIMITADA: Poucos modelos/tamanhos dispon√≠veis para atender diferentes tipos de doces\n\n4. QUALIDADE INCONSISTENTE: Embalagens que chegam danificadas ou com defeitos\n\n5. ATENDIMENTO DEFICIENTE: Dificuldade de contato, demora nas respostas, falta de suporte p√≥s-venda",
                tips: "üí° DICA: Fa√ßa pesquisas diretas, leia avalia√ß√µes no Google, monitore grupos de Facebook de lojistas, converse com clientes atuais sobre suas dificuldades."
            }
        ]
    },
    3: {
        title: "üìû T√©cnicas de Qualifica√ß√£o",
        description: "Domine a metodologia BANT (Budget, Authority, Need, Timeline) para qualificar prospects de forma eficiente. Isso evita perda de tempo com clientes que n√£o t√™m potencial real de compra.",
        questions: [
            {
                label: "Crie 3 perguntas estrat√©gicas para qualificar o OR√áAMENTO do prospect:",
                explanation: "O objetivo √© descobrir se eles t√™m capacidade financeira para comprar, qual o volume de compras mensais, e se existe or√ßamento aprovado. Seja sutil, n√£o pergunte diretamente 'quanto voc√™s ganham'.",
                placeholder: "Exemplo de resposta:\n\n1. 'Qual o volume aproximado de embalagens que voc√™s trabalham por m√™s?' (descobre escala de compra)\n\n2. 'Voc√™s j√° t√™m um or√ßamento definido mensalmente para fornecedores de embalagens?' (verifica se h√° budget separado)\n\n3. 'Como voc√™s avaliam atualmente o investimento em embalagens - consideram um custo ou um investimento no neg√≥cio?' (entende mentalidade financeira)",
                tips: "üí° DICA: Pergunte sobre volume, n√£o sobre dinheiro. Pergunte sobre processos, n√£o sobre valores espec√≠ficos. Use perguntas consultivas."
            },
            {
                label: "Desenvolva 3 perguntas para identificar quem tem AUTORIDADE na decis√£o:",
                explanation: "Voc√™ precisa falar com quem realmente decide sobre compras. Muitas vezes o vendedor n√£o √© o decisor. Descubra a hierarquia de decis√£o para n√£o perder tempo.",
                placeholder: "Exemplo de resposta:\n\n1. 'Como funciona o processo de decis√£o para novos fornecedores aqui na loja?' (entende o fluxo)\n\n2. 'Al√©m de voc√™, quem mais participa da escolha dos fornecedores de embalagens?' (identifica outros envolvidos)\n\n3. 'Para aprovarmos uma parceria, voc√™ precisa consultar algu√©m ou a decis√£o √© sua?' (confirma autonomia)",
                tips: "üí° DICA: Seja respeitoso ao perguntar sobre hierarquia. Use termos como 'processo' e 'equipe' ao inv√©s de questionar autoridade diretamente."
            },
            {
                label: "Formule 3 perguntas para identificar a real NECESSIDADE:",
                explanation: "Descubra se eles realmente precisam do que voc√™ oferece, quais problemas enfrentam com fornecedores atuais, e o n√≠vel de satisfa√ß√£o atual. Sem necessidade real, n√£o h√° venda.",
                placeholder: "Exemplo de resposta:\n\n1. 'Como voc√™s escolheram os fornecedores atuais de embalagens? O que mais pesou na decis√£o?' (entende crit√©rios)\n\n2. 'Se pudessem melhorar uma coisa nos fornecedores atuais, o que seria?' (descobre insatisfa√ß√µes)\n\n3. 'Voc√™s j√° tiveram alguma situa√ß√£o onde faltou embalagem ou chegou com defeito? Como resolveram?' (identifica dores reais)",
                tips: "üí° DICA: Foque em problemas, n√£o em produtos. Deixe o cliente falar sobre suas dificuldades. Use perguntas abertas que come√ßam com 'como', 'o que', 'por que'."
            }
        ]
    },
    4: {
        title: "üìß Scripts de E-mail",
        description: "Desenvolva e-mails que realmente chamam aten√ß√£o e geram respostas. E-mails gen√©ricos s√£o ignorados. Aprenda a personalizar e criar valor desde o primeiro contato.",
        questions: [
            {
                label: "Crie um e-mail de primeiro contato personalizado para uma loja de doces:",
                explanation: "Deve incluir: assunto atrativo, personaliza√ß√£o (mencionar algo espec√≠fico da loja), proposta de valor clara, call-to-action simples, e ser conciso (m√°ximo 100 palavras no corpo).",
                placeholder: "Exemplo de resposta:\n\nAssunto: Aumentar lucro da [Nome da Loja] em 15% - 5 minutos?\n\nOl√° [Nome],\n\nVi que a [Nome da Loja] tem √≥timas avalia√ß√µes no Google e imagino que voc√™s trabalham com um bom volume de embalagens.\n\nAjudamos a Do√ßura Premium (similar √† sua loja) a aumentar a margem de lucro em 15% otimizando fornecedores de embalagens.\n\nTem 5 minutos esta semana para eu mostrar como?\n\nAbra√ßos,\n[Seu nome]\n[Telefone]\nEmbalagens Conceito",
                tips: "üí° DICA: Pesquise a loja no Google, veja fotos, leia avalia√ß√µes. Mencione algo espec√≠fico. Use n√∫meros (15%, 5 minutos). Inclua prova social (cliente similar)."
            },
            {
                label: "Desenvolva um e-mail de follow-up para quando n√£o h√° resposta:",
                explanation: "Deve ser diferente do primeiro, agregar novo valor, criar urg√™ncia suave, oferecer sa√≠da f√°cil, e manter tom amistoso. Muitas vendas acontecem no follow-up.",
                placeholder: "Exemplo de resposta:\n\nAssunto: Re: [Nome da Loja] + √∫ltima tentativa üòä\n\nOi [Nome],\n\nSei que devem estar com a agenda apertada (loja movimentada √© bom sinal!).\n\nPensei em compartilhar rapidamente: a Doce Momento economizou R$ 2.400 no √∫ltimo trimestre mudando apenas 2 fornecedores.\n\nSe n√£o fizer sentido para voc√™s agora, sem problemas - pode me avisar que paro de incomodar üòä\n\nCaso contr√°rio, que tal 10 minutos no WhatsApp ainda esta semana?\n\nAbra√ßos,\n[Seu nome]",
                tips: "üí° DICA: Seja emp√°tico ('sei que est√£o ocupados'). Agregue novo valor (novo case, economia). Ofere√ßa sa√≠da f√°cil. Use emojis com modera√ß√£o."
            }
        ]
    },
    5: {
        title: "‚òéÔ∏è Scripts de Cold Call",
        description: "Domine as liga√ß√µes de prospec√ß√£o com abordagens que funcionam. Cold calls bem feitos ainda s√£o uma das ferramentas mais eficazes para SDRs, mas precisam ser estrat√©gicos.",
        questions: [
            {
                label: "Desenvolva uma abertura de cold call de 30 segundos para lojistas:",
                explanation: "Deve incluir: apresenta√ß√£o r√°pida, motivo da liga√ß√£o, benef√≠cio claro, pedido de permiss√£o para continuar. Tempo limitado for√ßa voc√™ a ir direto ao ponto mais importante.",
                placeholder: "Exemplo de resposta:\n\n'Ol√° [Nome]! Aqui √© [Seu Nome] da Embalagens Conceito. Estou ligando porque vi que voc√™s t√™m uma loja de doces muito bem avaliada e imagino que trabalham com um volume interessante de embalagens.\n\nTenho ajudado lojas similares √† sua a economizar entre 10-20% nos custos de embalagens mantendo a mesma qualidade.\n\nTenho 2 minutos para explicar como isso funciona ou peguei voc√™s em um momento ruim?'\n\n[PAUSA PARA RESPOSTA]",
                tips: "üí° DICA: Pratique cronometrando. Fale devagar e clara. Fa√ßa uma pergunta no final. Esteja preparado para obje√ß√µes. Sorria ao falar (muda o tom de voz)."
            },
            {
                label: "Crie uma resposta completa para a obje√ß√£o 'J√° temos fornecedor e estamos satisfeitos':",
                explanation: "Esta √© a obje√ß√£o mais comum. Sua resposta deve: validar a obje√ß√£o, fazer uma pergunta inteligente, criar curiosidade, e propor pr√≥ximo passo pequeno. N√£o tente vender na obje√ß√£o.",
                placeholder: "Exemplo de resposta:\n\n'Entendo perfeitamente, [Nome]! Na verdade, 90% dos nossos clientes tamb√©m tinham fornecedores quando nos conheceram.\n\nUma pergunta r√°pida: voc√™s est√£o 100% satisfeitos com prazo de entrega, variedade de produtos e pre√ßos? Ou existe sempre algo que poderia melhorar?\n\n[PAUSA PARA RESPOSTA]\n\n√â que nossa proposta n√£o √© substituir o que funciona, mas complementar com itens que talvez voc√™s n√£o encontrem facilmente, ou backup para quando o fornecedor principal falha.\n\nQue tal eu mostrar em 5 minutos como isso funciona, sem compromisso?'",
                tips: "üí° DICA: Nunca critique o fornecedor atual. Use estat√≠sticas (90% dos clientes). Fa√ßa perguntas que criam d√∫vidas. Ofere√ßa complemento, n√£o substitui√ß√£o."
            }
        ]
    },
    6: {
        title: "üîç Pesquisa e Prospecting",
        description: "Aprenda a encontrar prospects qualificados de forma sistem√°tica e eficiente. Prospecting bem feito √© 50% do sucesso em vendas. Qualidade √© mais importante que quantidade.",
        questions: [
            {
                label: "Liste 5 fontes espec√≠ficas e m√©todos para encontrar lojistas qualificados:",
                explanation: "Pense em fontes online e offline, ferramentas gratuitas e pagas, m√©todos diretos e indiretos. Inclua como usar cada fonte e que tipo de informa√ß√£o voc√™ pode obter de cada uma.",
                placeholder: "Exemplo de resposta:\n\n1. GOOGLE MAPS: Buscar 'loja de doces + [cidade]' - permite ver localiza√ß√£o, fotos, hor√°rios, avalia√ß√µes e contato direto\n\n2. INSTAGRAM/FACEBOOK: Buscar hashtags #doceria #confeitaria [cidade] - mostra engajamento, estilo da loja, eventos, promo√ß√µes\n\n3. SHOPPINGS CENTERS: Visita presencial aos corredores de alimenta√ß√£o - observa√ß√£o direta do movimento, conversa com lojistas\n\n4. ASSOCIA√á√ïES COMERCIAIS: SEBRAE, CDL, sindicatos locais - listas de associados, eventos de networking\n\n5. INDICA√á√ïES DE CLIENTES: Perguntar 'conhece outras lojas que poderiam se interessar?' - leads mais qualificados",
                tips: "üí° DICA: Combine m√©todos online e offline. Foque primeiro em sua regi√£o. Use ferramentas gratuitas antes de pagar. Organize tudo em planilha."
            },
            {
                label: "Defina quais informa√ß√µes essenciais coletar ANTES de fazer o primeiro contato:",
                explanation: "Informa√ß√µes que ajudam na personaliza√ß√£o, qualifica√ß√£o inicial, e estrat√©gia de abordagem. Pense em dados que voc√™ pode descobrir sem falar com eles ainda.",
                placeholder: "Exemplo de resposta:\n\n‚Ä¢ NOME DO RESPONS√ÅVEL: Dono, gerente ou pessoa que decide compras\n‚Ä¢ TEMPO DE MERCADO: H√° quanto tempo a loja existe (estabilidade)\n‚Ä¢ LOCALIZA√á√ÉO ESTRAT√âGICA: Shopping, rua, centro - indica movimento\n‚Ä¢ PRESEN√áA DIGITAL: Site, redes sociais ativas, engajamento\n‚Ä¢ ESTILO/P√öBLICO: Doces finos, populares, infantis, eventos\n‚Ä¢ TAMANHO APARENTE: Quantidade de funcion√°rios, tamanho da loja\n‚Ä¢ CONCORRENTES PR√ìXIMOS: Quantas lojas similares na regi√£o\n‚Ä¢ AVALIA√á√ïES ONLINE: Google, Facebook - satisfa√ß√£o dos clientes\n‚Ä¢ PRODUTOS VENDIDOS: Al√©m de doces, vendem embalagens?",
                tips: "üí° DICA: Use Google Street View para 'visitar' a loja. Verifique se t√™m delivery (indica volume). Veja posts recentes nas redes sociais."
            }
        ]
    },
    7: {
        title: "üõ°Ô∏è Tratamento de Obje√ß√µes",
        description: "Transforme obje√ß√µes em oportunidades de venda. Obje√ß√µes s√£o naturais e muitas vezes indicam interesse. Aprenda a trat√°-las com confian√ßa e t√©cnica, n√£o com press√£o.",
        questions: [
            {
                label: "Desenvolva uma resposta completa para: 'Seus pre√ßos s√£o muito altos':",
                explanation: "Esta obje√ß√£o √© sobre valor percebido, n√£o sobre pre√ßo. Sua resposta deve: reconhecer a preocupa√ß√£o, fazer perguntas investigativas, apresentar valor/ROI, usar prova social, e propor pr√≥ximo passo.",
                placeholder: "Exemplo de resposta:\n\n'Entendo sua preocupa√ß√£o com investimento, [Nome]. Posso perguntar: voc√™s est√£o comparando apenas o pre√ßo unit√°rio ou o custo-benef√≠cio total?\n\n[PAUSA]\n\nPor exemplo, a Loja Doce Paix√£o pensava igual. A√≠ calculamos: economizaram R$ 1.200 em 3 meses porque nossas embalagens t√™m menos quebra no transporte e melhor aceita√ß√£o dos clientes.\n\nAl√©m disso, nossa entrega √© em 24h (n√£o 7 dias), ent√£o n√£o precisam estocar tanto.\n\nQue tal eu mostrar essa conta completa para sua realidade? Pode ser que o 'investimento maior' na verdade seja uma economia no final das contas.'",
                tips: "üí° DICA: Nunca baixe pre√ßo na primeira obje√ß√£o. Foque em valor total, n√£o pre√ßo unit√°rio. Use cases reais. Mostre ROI calculado."
            },
            {
                label: "Crie uma resposta estrat√©gica para: 'N√£o temos tempo agora, ligam depois':",
                explanation: "Esta √© uma obje√ß√£o de timing, n√£o de interesse. Pode ser real ou desculpa. Sua resposta deve: validar a situa√ß√£o, criar urg√™ncia suave, propor alternativa flex√≠vel, e garantir follow-up definido.",
                placeholder: "Exemplo de resposta:\n\n'Imagino mesmo, [Nome]! Loja movimentada √© sinal de que as coisas v√£o bem, parab√©ns!\n\nUma pergunta r√°pida: essa correria √© mais sazonal (√©poca espec√≠fica) ou voc√™s est√£o sempre nesse ritmo?\n\n[ESCUTA A RESPOSTA]\n\nEntendo. Olha, justamente por isso que pode fazer sentido conversarmos. Muitos dos nossos clientes economizam at√© 3 horas por semana s√≥ organizando melhor os fornecedores.\n\nQue tal assim: eu mando um WhatsApp com um case r√°pido de 2 minutos, a√≠ quando voc√™s tiverem um tempinho, d√£o uma olhada? Sem press√£o.\n\nQual o melhor n√∫mero para mandar?'",
                tips: "üí° DICA: Valide a situa√ß√£o real. Conecte sua solu√ß√£o com a falta de tempo deles. Ofere√ßa formato que n√£o demanda tempo imediato."
            }
        ]
    },
    8: {
        title: "üîÑ Follow-up Estrat√©gico",
        description: "Desenvolva um sistema de acompanhamento que converte prospects ao longo do tempo. A maioria das vendas B2B acontece entre o 5¬∫ e 12¬∫ contato. Seja sistem√°tico, n√£o invasivo.",
        questions: [
            {
                label: "Crie um cronograma de follow-up de 30 dias com 6 pontos de contato:",
                explanation: "Inclua: canal de contato (e-mail, liga√ß√£o, WhatsApp), objetivo de cada contato, tipo de valor agregado, e timing espec√≠fico. Varie os canais e tipos de abordagem.",
                placeholder: "Exemplo de resposta:\n\nDIA 1: E-mail inicial personalizado (primeiro contato)\nDIA 3: Liga√ß√£o de follow-up (verificar recebimento do e-mail)\nDIA 7: WhatsApp com case de sucesso relevante\nDIA 14: E-mail com dica valiosa do setor + proposta simples\nDIA 21: Liga√ß√£o final com oferta espec√≠fica/urg√™ncia\nDIA 30: E-mail de '√∫ltima tentativa' com sa√≠da educada\n\n* Entre os contatos: monitorar redes sociais, comentar posts, engajar sutilmente\n* Ap√≥s dia 30: adicionar √† lista de nutri√ß√£o mensal (1 contato por m√™s)",
                tips: "üí° DICA: Varie sempre o canal. Agregue valor novo a cada contato. Tenha um CRM simples para controlar. Respeite quem pedir para parar."
            },
            {
                label: "Desenvolva 4 tipos diferentes de valor para agregar em cada follow-up:",
                explanation: "Pense em conte√∫dos √∫teis que demonstram expertise e ajudam o lojista, mesmo que ele n√£o compre. Valor educativo constr√≥i relacionamento e credibilidade a longo prazo.",
                placeholder: "Exemplo de resposta:\n\n1. CASES DE SUCESSO: 'Como a Loja X aumentou vendas em 25% mudando apenas o tipo de embalagem para presentes'\n\n2. DICAS DE MERCADO: 'Tend√™ncia: embalagens sustent√°veis aumentaram procura em 40% no √∫ltimo trimestre'\n\n3. FERRAMENTAS √öTEIS: 'Calculadora gratuita: descubra se suas embalagens est√£o com pre√ßo competitivo'\n\n4. ALERTAS SAZONAIS: 'Faltam 45 dias para Dia das M√£es - hist√≥rico mostra aumento de 60% na demanda por embalagens de presente'\n\n* B√¥nus: Convites para eventos, webinars, ou networking do setor",
                tips: "üí° DICA: Crie um banco de conte√∫dos √∫teis. Use dados e estat√≠sticas. Conecte sempre com a realidade do lojista. Seja consultivo."
            }
        ]
    }
};

// Inicializar SDR
function initializeSDR() {
    const name = document.getElementById('sdrName').value.trim();
    const email = document.getElementById('sdrEmail').value.trim();
    
    if (!name || !email) {
        alert('Por favor, preencha seu nome e e-mail para continuar.');
        return;
    }
    
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        alert('Por favor, insira um e-mail v√°lido.');
        return;
    }
    
    currentSDR = { name, email };
    sessionId = generateSessionId();
    trainingStartTime = new Date();
    
    // Salvar in√≠cio da sess√£o
    saveToFirebase('session_start', {
        sdrName: name,
        sdrEmail: email,
        sessionId: sessionId,
        startTime: trainingStartTime,
        status: 'iniciado'
    });
    
    // Atualizar interface
    document.getElementById('loginForm').style.display = 'none';
    document.getElementById('sdrInfo').style.display = 'block';
    document.getElementById('currentSDRName').textContent = name;
    document.getElementById('startTime').textContent = trainingStartTime.toLocaleString('pt-BR');
    document.getElementById('progressText').textContent = '0% Conclu√≠do - Clique em um m√≥dulo para come√ßar';
    
    // Habilitar cards
    enableTraining();
}

// Logout do SDR
function logoutSDR() {
    if (confirm('Tem certeza que deseja finalizar a sess√£o? O progresso ser√° salvo.')) {
        saveToFirebase('session_end', {
            sessionId: sessionId,
            endTime: new Date(),
            status: 'finalizado'
        });
        location.reload();
    }
}

// Gerar ID √∫nico da sess√£o
function generateSessionId() {
    return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
}

// Habilitar treinamento
function enableTraining() {
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
        card.classList.remove('card-disabled');
        card.addEventListener('click', () => {
            const moduleNum = parseInt(card.dataset.module);
            openModule(moduleNum);
        });
    });
}

// Abrir m√≥dulo
function openModule(moduleNum) {
    if (!currentSDR) {
        alert('Fa√ßa login primeiro!');
        return;
    }
    
    currentModule = moduleNum;
    const module = moduleData[moduleNum];
    
    document.getElementById('modalTitle').textContent = module.title;
    
    const modalBody = document.getElementById('modalBody');
    modalBody.innerHTML = '';
    
    // Adicionar descri√ß√£o do m√≥dulo
    const descriptionDiv = document.createElement('div');
    descriptionDiv.innerHTML = `
        <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; margin-bottom: 25px; border-left: 4px solid #3b82f6;">
            <h4 style="color: #1e40af; margin-bottom: 10px; font-size: 1.1rem;">üìö Sobre este m√≥dulo:</h4>
            <p style="color: #1e3a8a; line-height: 1.6; margin: 0;">${module.description}</p>
        </div>
    `;
    modalBody.appendChild(descriptionDiv);
    
    module.questions.forEach((question, index) => {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'practice-area';
        questionDiv.innerHTML = `
            <label style="font-size: 1.1rem; color: #1a365d; margin-bottom: 15px; display: block; font-weight: bold;">
                ${question.label}
            </label>
            
            <div style="background: #fef7e0; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #f59e0b;">
                <h5 style="color: #92400e; margin-bottom: 8px; font-size: 0.95rem;">üí° Como desenvolver uma boa resposta:</h5>
                <p style="color: #78350f; line-height: 1.5; margin: 0; font-size: 0.9rem;">${question.explanation}</p>
            </div>
            
            ${question.tips ? `
                <div style="background: #ecfdf5; padding: 12px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #10b981;">
                    <p style="color: #047857; line-height: 1.4; margin: 0; font-size: 0.85rem; font-weight: 500;">${question.tips}</p>
                </div>
            ` : ''}
            
            <textarea 
                id="question_${moduleNum}_${index}" 
                placeholder="${question.placeholder}"
                data-module="${moduleNum}"
                data-question="${index}"
                style="min-height: 180px; font-size: 14px; line-height: 1.5;">
            </textarea>
            
            <div style="margin-top: 8px; font-size: 0.8rem; color: #718096;">
                <span id="charCount_${moduleNum}_${index}">0</span> caracteres ‚Ä¢ M√≠nimo recomendado: 200 caracteres
            </div>
        `;
        modalBody.appendChild(questionDiv);
    });
    
    // Atualizar status de completude
    updateCompletionStatus(moduleNum);
    
    // Adicionar listeners
    addTextareaListeners(moduleNum);
    
    document.getElementById('trainingModal').style.display = 'block';
}

// Fechar modal
function closeModal() {
    document.getElementById('trainingModal').style.display = 'none';
}

// Adicionar listeners aos textareas
function addTextareaListeners(moduleNum) {
    const textareas = document.querySelectorAll(`textarea[data-module="${moduleNum}"]`);
    textareas.forEach(textarea => {
        // Atualizar contador de caracteres
        function updateCharCount() {
            const charCount = textarea.value.length;
            const countSpan = document.getElementById(`charCount_${moduleNum}_${textarea.dataset.question}`);
            if (countSpan) {
                countSpan.textContent = charCount;
                countSpan.style.color = charCount >= 200 ? '#059669' : '#dc2626';
            }
        }
        
        // Event listeners
        textarea.addEventListener('input', function() {
            const questionIndex = this.dataset.question;
            const module = moduleData[moduleNum];
            
            // Salvar no Firebase
            saveToFirebase('answer', {
                sessionId: sessionId,
                moduleNumber: moduleNum,
                moduleTitle: module.title,
                questionIndex: parseInt(questionIndex),
                question: module.questions[questionIndex].label,
                answer: this.value,
                timestamp: new Date(),
                characterCount: this.value.length
            });
            
            // Atualizar contador
            updateCharCount();
            
            // Atualizar status de completude
            updateCompletionStatus(moduleNum);
        });
        
        // Inicializar contador
        updateCharCount();
    });
}

// Atualizar status de completude do m√≥dulo
function updateCompletionStatus(moduleNum) {
    const textareas = document.querySelectorAll(`textarea[data-module="${moduleNum}"]`);
    const totalQuestions = textareas.length;
    let answeredCount = 0;
    
    textareas.forEach(textarea => {
        if (textarea.value.trim().length >= 50) { // M√≠nimo de 50 caracteres
            answeredCount++;
        }
    });
    
    document.getElementById('answeredCount').textContent = answeredCount;
    document.getElementById('totalQuestions').textContent = totalQuestions;
    
    const completeBtn = document.getElementById('completeBtn');
    if (answeredCount === totalQuestions) {
        completeBtn.disabled = false;
        completeBtn.textContent = 'Concluir M√≥dulo ‚úì';
        completeBtn.style.background = 'linear-gradient(135deg, #059669 0%, #047857 100%)';
    } else {
        completeBtn.disabled = true;
        completeBtn.textContent = `Concluir M√≥dulo (${answeredCount}/${totalQuestions})`;
        completeBtn.style.background = '#a0aec0';
    }
}

// Completar m√≥dulo
function completeModule() {
    if (!currentModule) return;
    
    const textareas = document.querySelectorAll(`textarea[data-module="${currentModule}"]`);
    let allAnswered = true;
    let incompleteQuestions = [];
    
    textareas.forEach((textarea, index) => {
        if (textarea.value.trim().length < 50) {
            allAnswered = false;
            incompleteQuestions.push(index + 1);
        }
    });
    
    if (!allAnswered) {
        alert(`Por favor, complete as perguntas: ${incompleteQuestions.join(', ')}.\nCada resposta deve ter pelo menos 50 caracteres para ser considerada completa.`);
        return;
    }
    
    // Verificar qualidade m√≠nima das respostas
    let shortAnswers = [];
    textareas.forEach((textarea, index) => {
        if (textarea.value.trim().length < 200) {
            shortAnswers.push(index + 1);
        }
    });
    
    if (shortAnswers.length > 0) {
        const proceed = confirm(`As perguntas ${shortAnswers.join(', ')} t√™m menos de 200 caracteres.\n\nRecomendamos respostas mais detalhadas para melhor aproveitamento do treinamento.\n\nDeseja continuar mesmo assim?`);
        if (!proceed) return;
    }
    
    // Marcar m√≥dulo como conclu√≠do
    if (!completedModules.includes(currentModule)) {
        completedModules.push(currentModule);
        
        // Salvar conclus√£o do m√≥dulo
        saveToFirebase('module_completed', {
            sessionId: sessionId,
            moduleNumber: currentModule,
            moduleTitle: moduleData[currentModule].title,
            completionTime: new Date(),
            answersQuality: textareas.length > 0 ? 
                Array.from(textareas).map(t => ({
                    length: t.value.length,
                    quality: t.value.length >= 200 ? 'good' : t.value.length >= 100 ? 'fair' : 'poor'
                })) : []
        });
        
        // Atualizar visual do card
        const card = document.querySelector(`[data-module="${currentModule}"]`);
        card.classList.add('completed');
        const statusElement = card.querySelector('.card-status');
        statusElement.textContent = 'Conclu√≠do ‚úì';
        statusElement.style.color = '#38a169';
        statusElement.style.fontWeight = 'bold';
        
        updateProgress();
        
        // Feedback positivo
        setTimeout(() => {
            alert(`üéâ Parab√©ns! M√≥dulo "${moduleData[currentModule].title}" conclu√≠do com sucesso!\n\nSuas respostas foram salvas e enviadas para avalia√ß√£o.`);
        }, 500);
    }
    
    closeModal();
}

// Atualizar progresso geral
function updateProgress() {
    const totalModules = Object.keys(moduleData).length;
    const progress = Math.round((completedModules.length / totalModules) * 100);
    
    document.getElementById('progressFill').style.width = progress + '%';
    document.getElementById('progressText').textContent = `${progress}% Conclu√≠do (${completedModules.length}/${totalModules} m√≥dulos)`;
    
    // Salvar progresso
    saveToFirebase('progress', {
        sessionId: sessionId,
        progress: progress,
        completedModules: completedModules.length,
        totalModules: totalModules,
        timestamp: new Date()
    });
    
    // Verificar se terminou
    if (progress === 100) {
        setTimeout(() => {
            saveToFirebase('training_completed', {
                sessionId: sessionId,
                completionTime: new Date(),
                totalDuration: new Date() - trainingStartTime
            });
            
            alert('üéâ Parab√©ns! Voc√™ concluiu o treinamento SDR! Suas respostas foram enviadas para avalia√ß√£o.');
        }, 500);
    }
}

// Salvar dados no Firebase
async function saveToFirebase(type, data) {
    try {
        await db.collection('sdr_training').add({
            type: type,
            data: data,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        console.log('Dados salvos:', type);
    } catch (error) {
        console.error('Erro ao salvar:', error);
    }
}

// Fechar modal clicando fora
window.onclick = function(event) {
    const modal = document.getElementById('trainingModal');
    if (event.target === modal) {
        closeModal();
    }
}

// Salvar estado ao sair
window.addEventListener('beforeunload', function() {
    if (currentSDR) {
        saveToFirebase('session_pause', {
            sessionId: sessionId,
            pauseTime: new Date(),
            status: 'pausado'
        });
    }
});
</script>
</body>
</html>
